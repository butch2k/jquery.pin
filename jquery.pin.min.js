(function(e){"use strict";e.fn.pin=function(t){var n=0,r=[],i=false,s=e(window);t=t||{};var o=function(){for(var n=0,o=r.length;n<o;n++){var u=r[n];if(t.minWidth&&s.width()<=t.minWidth){if(u.parent().is(".pin-wrapper")){u.unwrap()}u.css({width:"",left:"",top:"",position:""});i=true;continue}else if(t.minHeight&&s.height()<=t.minHeight){if(u.parent().is(".pin-wrapper")){u.unwrap()}u.css({width:"",left:"",top:"",position:""});i=true;continue}else{i=false}var a=t.containerSelector?u.closest(t.containerSelector):e(document.body);var f=u.offset();var l=a.offset();var c=u.offsetParent().offset();if(!u.parent().is(".pin-wrapper")){u.wrap("<div class='pin-wrapper'>")}u.data("pin",{from:t.containerSelector?l.top:f.top,to:l.top+a.height()-u.outerHeight(),end:l.top+a.height(),parentTop:c.top});u.css({width:u.innerWidth()})}};var u=function(){if(i){return}n=s.scrollTop();for(var t=0,o=r.length;t<o;t++){var u=e(r[t]),a=u.data("pin"),f=a.from,l=a.to;if(f+u.outerHeight()>a.end){u.css("position","");continue}if(f<n&&l>n){!(u.css("position")=="fixed")&&u.css({left:u.offset().left,top:0}).css("position","fixed")}else if(n>=l){u.css({left:"auto",top:l-a.parentTop}).css("position","absolute")}else{u.css({position:"",top:"",left:""})}}};var a=function(){o();u()};this.each(function(){var t=e(this),n=e(this).data("pin")||{};if(n&&n.update){return}r.push(t);e("img",this).one("load",o);n.update=a;e(this).data("pin",n)});s.scroll(u);s.resize(function(){o()});o();s.load(a);return this}})(jQuery);
